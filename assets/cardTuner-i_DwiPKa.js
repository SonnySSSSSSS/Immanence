import{U as e}from"./index-NOppfZ3u.js";var t=`[data-card-id]`,n=`dev-card-tuner-enabled`,r=`dev-card-picker-active`,i=`dev-card-selected`,a=`dev.cardTuner.global.v1`,o=`dev.cardTuner.cards.v1`,s=Object.freeze({cardTintH:220,cardTintS:20,cardTintL:12,cardAlpha:.22,cardBorderAlpha:.28,cardBlur:16}),c=null,l=null,u=!1,d=!1,f={...s},p={},m=new Set,h=null,g={cardTintH:`--card-tint-h`,cardTintS:`--card-tint-s`,cardTintL:`--card-tint-l`,cardAlpha:`--card-alpha`,cardBorderAlpha:`--card-border-alpha`,cardBlur:`--card-blur`};function _(){return typeof window<`u`&&typeof document<`u`&&e()}function v(e={}){let t={...s,...e};return{cardTintH:Math.max(0,Math.min(360,Number(t.cardTintH)||0)),cardTintS:Math.max(0,Math.min(100,Number(t.cardTintS)||0)),cardTintL:Math.max(0,Math.min(100,Number(t.cardTintL)||0)),cardAlpha:Math.max(0,Math.min(1,Number(t.cardAlpha)||0)),cardBorderAlpha:Math.max(0,Math.min(1,Number(t.cardBorderAlpha)||0)),cardBlur:Math.max(0,Math.min(60,Number(t.cardBlur)||0))}}function y(){let e=G();m.forEach(t=>t(e))}function b(e,t){if(!_())return t;try{let n=localStorage.getItem(e);return n?JSON.parse(n):t}catch{return t}}function x(e,t){if(_())try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function S(e){if(_())try{localStorage.removeItem(e)}catch{}}function C(e,t){e.setProperty(g.cardTintH,`${t.cardTintH}`),e.setProperty(g.cardTintS,`${t.cardTintS}%`),e.setProperty(g.cardTintL,`${t.cardTintL}%`),e.setProperty(g.cardAlpha,`${t.cardAlpha}`),e.setProperty(g.cardBorderAlpha,`${t.cardBorderAlpha}`),e.setProperty(g.cardBlur,`${t.cardBlur}px`)}function w(e){Object.values(g).forEach(t=>e.removeProperty(t))}function T(){_()&&Object.entries(p).forEach(([e,t])=>{document.querySelectorAll(`[data-card-id="${e}"]`).forEach(e=>{C(e.style,v(t))})})}function E(e){return e instanceof Element?`${e.tagName?.toLowerCase?.()||`element`}${e.id?`#${e.id}`:``}${typeof e.className==`string`&&e.className.trim()?`.${e.className.trim().split(/\s+/g).slice(0,3).join(`.`)}`:``}`:`unknown`}function D(e){if(!(e instanceof Element))return{};try{return e.dataset?{...e.dataset}:{}}catch{return{}}}function O(e,t=12){let n=[],r=e instanceof Element?e:null;for(;r&&n.length<t;)n.push({tag:String(r.tagName||``).toLowerCase(),class:typeof r.className==`string`?r.className:null,dataset:D(r)}),r=r.parentElement;return n}function k(e,t){if(!(!d||!_()))try{let n=e?.target instanceof Element?e.target:null,r={mode:`card`,picker:`legacy`,target:n?{tag:n.tagName.toLowerCase(),class:typeof n.className==`string`?n.className:null,dataset:D(n)}:null,ancestors:O(n,12),resolved:t?{tag:t.tagName.toLowerCase(),class:typeof t.className==`string`?t.className:null,dataset:D(t)}:null,resolvedId:t?.getAttribute?.(`data-card-id`)||null};console.info(`[pick-debug] ${JSON.stringify(r)}`)}catch(e){console.info(`[pick-debug] failed to log`,e)}}function A(e){if(!_())return null;let t=e?.target instanceof Element?e.target:null;return t?t.closest(`[data-card-id]`):null}function j(e){let t=typeof e?.composedPath==`function`?e.composedPath():null;if(!Array.isArray(t))return!1;for(let e of t){if(!(e instanceof Element))continue;if(e.getAttribute?.(`data-devpanel-root`)===`true`)return!0;let t=e.getAttribute?.(`data-testid`);if(t===`devpanel-root`||t===`devpanel-peek`)return!0}return!1}function M(e){if(!u||j(e))return;let t=A(e);if(k(e,t),!t){h={reason:`no-card-marker-ancestor`,message:`Pick failed: no [data-card-id] ancestor found (clicked ${E(e?.target)}).`},y();return}t.getAttribute(`data-card-id`)&&(L(t),e.preventDefault(),e.stopPropagation(),typeof e.stopImmediatePropagation==`function`&&e.stopImmediatePropagation(),h=null,y())}function N(){return _()?(f=v(b(a,s)),p=b(o,{})||{},document.documentElement.classList.add(n),C(document.documentElement.style,f),T(),y(),G()):G()}function P(e){return m.add(e),e(G()),()=>m.delete(e)}function F(e){_()&&(u=!!e,document.documentElement.classList.toggle(r,u),document.removeEventListener(`click`,M,!0),u&&document.addEventListener(`click`,M,!0),y())}function I(e){d=!!e}function L(e){_()&&(c&&c.classList.remove(i),c=e?.closest?.(t)||null,l=null,c&&(c.classList.add(i),l=c.closest?.(`[data-card-carousel-root]`)?.getAttribute?.(`data-card-carousel-root`)||c.getAttribute?.(`data-card-carousel`)||null,c.classList.contains(`im-card`)||console.info(`[cardTuner] Card not using tunable vars`)),y())}function R(e){_()&&(f=v(e),C(document.documentElement.style,f),y())}function z(e){!_()||!c||(C(c.style,v(e)),y())}function B(e){f=v(e||f),x(a,f),R(f)}function V(e){if(!c)return;let t=c.dataset.cardId;t&&(p[t]=v(e),x(o,p),z(e))}function H(){f={...s},S(a),R(f)}function U(){if(!c)return;let e=c.dataset.cardId;w(c.style),e&&p[e]&&(delete p[e],x(o,p)),y()}function W(){_()&&(S(a),S(o),p={},f={...s},R(f),document.querySelectorAll(t).forEach(e=>w(e.style)),y())}function G(){return{pickMode:u,selectedCardId:c?.dataset?.cardId||null,selectedCardCarouselId:l,selectedLabel:c?.dataset?.cardId||c?.tagName?.toLowerCase()||null,hasSelected:!!c,lastPickFailure:h,globalSettings:{...f},selectedSettings:c?K(c):null}}function K(e){let t=getComputedStyle(e),n=(e,n)=>{let r=Number.parseFloat(t.getPropertyValue(e).trim());return Number.isFinite(r)?r:n};return v({cardTintH:n(g.cardTintH,s.cardTintH),cardTintS:n(g.cardTintS,s.cardTintS),cardTintL:n(g.cardTintL,s.cardTintL),cardAlpha:n(g.cardAlpha,s.cardAlpha),cardBorderAlpha:n(g.cardBorderAlpha,s.cardBorderAlpha),cardBlur:n(g.cardBlur,s.cardBlur)})}const q=s;export{A as a,U as c,L as d,I as f,W as i,B as l,P as m,R as n,N as o,F as p,z as r,H as s,q as t,V as u};