import{G as e,U as t,Z as n,at as r,it as i}from"./index-NOppfZ3u.js";import{n as a,r as o}from"./pickerChannel-BlqIvKQn.js";import{c as s,o as c,r as l}from"./plateFxPresets-DA-YbPFg.js";var u=r(i(),1),d=`immanence.dev.platesFxPicker`,f=`immanence-plates-fx-picker`,p=`ui-accent-plate`,m=[`homeHub:plate:mode:practice`,`homeHub:plate:mode:wisdom`,`homeHub:plate:mode:application`,`homeHub:plate:mode:navigation`,`practice:plate:submode:cognitive`,`practice:plate:submode:somatic`,`practice:plate:submode:emotion`],h=[`--plate-bw`,`--plate-speed`,`--plate-border-opacity`,`--plate-glow`,`--plate-glow-opacity`,`--plate-bg-opacity`,`--plate-sheen`,`--plate-anim-name`,`--plate-c1`,`--plate-c2`,`--plate-c3`];function g(e,t,n){return Math.max(t,Math.min(n,e))}function _(e){let t=String(e||``).trim().replace(`#`,``);if(!/^[\da-f]{3}$|^[\da-f]{6}$/i.test(t))return null;let n=t.length===3?t.split(``).map(e=>`${e}${e}`).join(``):t,r=Number.parseInt(n.slice(0,2),16),i=Number.parseInt(n.slice(2,4),16),a=Number.parseInt(n.slice(4,6),16);return[r,i,a].every(Number.isFinite)?{r,g:i,b:a}:null}function v({r:e,g:t,b:n}){let r=e/255,i=t/255,a=n/255,o=Math.max(r,i,a),s=Math.min(r,i,a),c=o-s,l=0,u=0,d=(o+s)/2;if(c!==0)switch(u=c/(1-Math.abs(2*d-1)),o){case r:l=60*((i-a)/c%6);break;case i:l=60*((a-r)/c+2);break;default:l=60*((r-i)/c+4);break}return{h:(l+360)%360,s:u*100,l:d*100}}function y({h:e,s:t,l:n}){let r=g(t,0,100)/100,i=g(n,0,100)/100,a=(1-Math.abs(2*i-1))*r,o=a*(1-Math.abs(e/60%2-1)),s=i-a/2,c=0,l=0,u=0;e<60?[c,l,u]=[a,o,0]:e<120?[c,l,u]=[o,a,0]:e<180?[c,l,u]=[0,a,o]:e<240?[c,l,u]=[0,o,a]:e<300?[c,l,u]=[o,0,a]:[c,l,u]=[a,0,o];let d=e=>g(Math.round((e+s)*255),0,255).toString(16).padStart(2,`0`);return`#${d(c)}${d(l)}${d(u)}`}function b(e,{h:t=0,s:n=0,l:r=0}){return{h:(e.h+t+360)%360,s:g(e.s+n,0,100),l:g(e.l+r,0,100)}}function x(e){let t=v(_(e)||{r:255,g:210,b:120});return{c1:y(b(t,{h:10,s:6,l:9})),c2:y(b(t,{h:-14,s:10,l:-5})),c3:y(b(t,{h:28,s:2,l:12}))}}function S(){if(typeof window>`u`)return{selectedId:null};try{let e=a(d);return e?{selectedId:typeof e?.selectedId==`string`&&e.selectedId.length?e.selectedId:null}:{selectedId:null}}catch{return{selectedId:null}}}function C(){let r=n(e=>!!e.platesFxEnabled),[i,a]=(0,u.useState)(()=>S()),d=(0,u.useRef)(new Set),g=e()?.accent?.primary||`#FFD278`,_=(0,u.useCallback)(e=>{if(e instanceof Element){e.classList.remove(p);for(let t of h)e.style.removeProperty(t)}},[]),v=(0,u.useCallback)((e,t,n={})=>{if(!(e instanceof Element))return;let r=x(t.colorMode===`custom`&&t.color?t.color:g);e.classList.add(p),e.style.setProperty(`--plate-bw`,`${t.effective.borderW}px`),e.style.setProperty(`--plate-speed`,`${t.effective.speed}s`),e.style.setProperty(`--plate-border-opacity`,`${t.effective.opacity}`),e.style.setProperty(`--plate-glow`,`${t.effective.glow}px`),e.style.setProperty(`--plate-glow-opacity`,`${t.effective.glowOpacity}`),e.style.setProperty(`--plate-bg-opacity`,`${t.effective.bgOpacity}`),e.style.setProperty(`--plate-sheen`,t.effective.sheen?`1`:`0`);let i=n.animate!==null&&n.animate!==void 0,a=window.matchMedia(`(prefers-reduced-motion: reduce)`).matches,o=i?t.effective.animate:t.effective.animate&&!a;e.style.setProperty(`--plate-anim-name`,o?`plateFlow`:`none`),e.style.setProperty(`--plate-c1`,r.c1),e.style.setProperty(`--plate-c2`,r.c2),e.style.setProperty(`--plate-c3`,r.c3)},[g]),y=(0,u.useCallback)(()=>{let e=l(),n=new Set([...m,...Object.keys(e||{}),...i?.selectedId?[i.selectedId]:[],...Array.from(d.current)]);for(let i of n){if(!i||typeof i!=`string`)continue;let n=`[data-ui-target="true"][data-ui-id="${CSS.escape(i)}"]`,a=Array.from(document.querySelectorAll(n));if(!a.length)continue;let o=e?.[i]||{},s=c(o),l=r&&t()&&s.enabled;for(let e of a)l?v(e,s,o):_(e)}d.current=n},[v,_,r,i?.selectedId]);return(0,u.useEffect)(()=>o(f,e=>{let t=e?.detail||null;if(!t){a(S());return}a({selectedId:typeof t.selectedId==`string`&&t.selectedId.length?t.selectedId:null})}),[]),(0,u.useEffect)(()=>s(()=>y()),[y]),(0,u.useEffect)(()=>{y()},[y,r,i.selectedId,g]),(0,u.useEffect)(()=>()=>{document.querySelectorAll(`.${p}`).forEach(e=>_(e)),d.current.clear()},[_]),null}var w=C;export{C as SelectedPlateOverlay,w as default};