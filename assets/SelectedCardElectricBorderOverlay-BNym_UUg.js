import{H as e,Z as t,at as n,it as r,rt as i,tt as a}from"./index-NOppfZ3u.js";import{m as o}from"./cardTuner-i_DwiPKa.js";import{t as s}from"./ElectricBorder-DBbRBp_i.js";var c=n(r(),1),l=i(),u=a(),d=22,f=`[data-card="true"]`;function p(e,t,n){return Math.max(t,Math.min(n,e))}function m(e){return typeof CSS<`u`&&typeof CSS.escape==`function`?CSS.escape(String(e)):String(e).replace(/["\\]/g,`\\$&`)}function h(e){if(typeof e!=`string`)return 0;let t=Number.parseFloat(e);return Number.isFinite(t)?t:0}function g(e){if(!(e instanceof Element))return 0;let t=window.getComputedStyle(e);return h(t.borderTopLeftRadius||t.borderRadius||`0`)}function _({selectedCardId:e,selectedCardCarouselId:t}){if(typeof document>`u`)return{targetEl:null,carouselRoot:null};let n=e?document.querySelector(`${f}[data-card-id="${m(e)}"]`):null,r=(t?document.querySelector(`[data-card-carousel-root="${m(t)}"]`):null)||n?.closest?.(`[data-card-carousel-root]`)||null;if(r){let e=r.querySelector(`${f}[data-card-active="true"]`)||r.querySelector(`[data-card-active="true"]`);if(e instanceof Element)return{targetEl:e,carouselRoot:r}}return{targetEl:n instanceof Element?n:null,carouselRoot:r}}function v(){let n=t(e=>!!e.cardElectricBorderEnabled),r=t(e=>!!e.reduceMotion),[i,a]=(0,c.useState)(null),[f,m]=(0,c.useState)(null),h=(0,c.useRef)(null),v=(0,c.useRef)(null),y=(0,c.useRef)(!1),b=(0,c.useRef)(!1),x=(0,c.useCallback)(()=>{b.current||(b.current=!0,window.requestAnimationFrame(()=>{if(b.current=!1,!n){m(null);return}let t=i?.selectedCardId||null,a=i?.selectedCardCarouselId||null;if(!t&&!a){m(null);return}let{targetEl:o,carouselRoot:s}=_({selectedCardId:t,selectedCardCarouselId:a});if(!(o instanceof Element)){m(null),e()&&!y.current&&(y.current=!0,console.warn(`[SelectedCardElectricBorderOverlay] No selected card element found for:`,{selectedCardId:t,selectedCardCarouselId:a}));return}y.current=!1;let c=o.getBoundingClientRect();if(!c||c.width<2||c.height<2){m(null);return}let l=g(o),u=c.left-d,f=c.top-d,p=c.width+d*2,x=c.height+d*2;m({style:{position:`fixed`,left:`${u}px`,top:`${f}px`,width:`${p}px`,height:`${x}px`,pointerEvents:`none`,zIndex:9997},width:p,height:x,innerRect:{x:d,y:d,width:c.width,height:c.height,radius:l},color:`rgba(255, 210, 120, 1)`,speed:r?0:.06,chaos:.14,carouselRoot:s,targetEl:o}),h.current&&(h.current.disconnect(),h.current.observe(o)),v.current&&(v.current.disconnect(),s instanceof Element&&v.current.observe(s,{subtree:!0,attributes:!0,attributeFilter:[`data-card-active`]}))}))},[n,r,i]);(0,c.useEffect)(()=>{if(!e())return;let t=o(e=>a(e));return()=>t()},[]),(0,c.useEffect)(()=>{if(h.current?.disconnect(),h.current=null,v.current?.disconnect(),v.current=null,!n){m(null);return}x(),h.current=typeof ResizeObserver<`u`?new ResizeObserver(()=>x()):null,v.current=typeof MutationObserver<`u`?new MutationObserver(()=>x()):null;let e=()=>x(),t=()=>x(),r=()=>x();return window.addEventListener(`scroll`,e,!0),window.addEventListener(`resize`,t),window.addEventListener(`dev:card-carousel-change`,r),()=>{window.removeEventListener(`scroll`,e,!0),window.removeEventListener(`resize`,t),window.removeEventListener(`dev:card-carousel-change`,r),h.current?.disconnect(),h.current=null,v.current?.disconnect(),v.current=null}},[n,x]);let S=(0,c.useMemo)(()=>{if(!n||!f)return null;let e=Math.max(1,Math.round(f.width)),t=Math.max(1,Math.round(f.height)),r=f.innerRect,i=p(Number(r?.radius)||0,0,Math.min(r.width,r.height)/2);return{style:f.style,width:e,height:t,innerRect:{...r,radius:i},color:f.color,speed:f.speed,chaos:f.chaos}},[n,f]);return!n||!S?null:(0,l.createPortal)((0,u.jsx)(`div`,{"data-dev-overlay":`selected-card-electric-border`,style:S.style,children:(0,u.jsx)(s,{width:S.width,height:S.height,innerRect:S.innerRect,color:S.color,speed:S.speed,chaos:S.chaos,thickness:2.2,showSparks:!1,clipToOutside:!0})}),document.body)}var y=v;export{v as SelectedCardElectricBorderOverlay,y as default};