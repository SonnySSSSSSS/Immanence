var e=`immanence.dev.controlsFxPresets.v2`,t=`immanence.dev.controlsFxPresets.v1`;const n=`immanence-controls-fx-presets-updated`;var r=2;const i=Object.freeze({thickness:2,speed:.052,chaos:.095,offsetPx:16,color:null,glow:18,blur:6,opacity:1});function a(){return typeof window<`u`&&typeof document<`u`}function o(e,t,n,r){let i=Number(e);return Number.isFinite(i)?Math.max(t,Math.min(n,i)):r}function s(e={}){return{thickness:o(e.thickness,1,12,i.thickness),speed:o(e.speed,0,.2,i.speed),chaos:o(e.chaos,0,.3,i.chaos),offsetPx:o(e.offsetPx,0,40,i.offsetPx),color:typeof e.color==`string`&&e.color.trim().length?e.color.trim():null,glow:o(e.glow,0,64,i.glow),blur:o(e.blur,0,24,i.blur),opacity:o(e.opacity,.1,1,i.opacity)}}function c(e){let t={};if(!e||typeof e!=`object`)return t;for(let[n,r]of Object.entries(e))!n||typeof n!=`string`||(t[n]=s(r||{}));return t}function l(e){if(!e)return{};try{let t=JSON.parse(e);return!t||typeof t!=`object`?{}:t.version===r&&t.presets&&typeof t.presets==`object`?c(t.presets):c(t)}catch{return{}}}function u(){if(!a())return{};let n=l(window.localStorage.getItem(e));if(Object.keys(n).length>0)return n;let r=l(window.localStorage.getItem(t));return Object.keys(r).length>0?(d(r),r):{}}function d(i){if(!a())return;let o=c(i);try{window.localStorage.setItem(e,JSON.stringify({version:r,presets:o})),window.localStorage.removeItem(t)}catch{}try{window.dispatchEvent(new CustomEvent(n))}catch{}}function f(e){if(!e||typeof e!=`string`)return{...i};let t=u()?.[e]||null;return s({...i,...t||{}})}function p(e,t){if(!a()||!e||typeof e!=`string`)return;let n=u(),r=s({...n?.[e]||{},...t||{}});d({...n,[e]:r})}function m(e){if(!a()||!e||typeof e!=`string`)return;let t=u();if(!t||typeof t!=`object`||!(e in t))return;let n={...t};delete n[e],d(n)}function h(){a()&&d({})}function g(){return JSON.stringify({version:r,presets:u()},null,2)}function _(e,{replace:t=!0}={}){if(!a())return{ok:!1,reason:`no-dom`};try{let n=JSON.parse(String(e||``)),r=n&&typeof n==`object`&&n.presets&&typeof n.presets==`object`?c(n.presets):c(n);return t?(d(r),{ok:!0,count:Object.keys(r).length}):(d({...u(),...r}),{ok:!0,count:Object.keys(r).length})}catch(e){return{ok:!1,reason:`invalid-json`,error:e}}}function v(e){if(!a()||typeof e!=`function`)return()=>{};let t=()=>e();return window.addEventListener(n,t),()=>window.removeEventListener(n,t)}export{h as a,v as c,_ as i,g as n,m as o,f as r,p as s,i as t};